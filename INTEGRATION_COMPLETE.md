# ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –ø–æ–¥–ø–∏—Å–æ–∫ - –ó–∞–≤–µ—Ä—à–µ–Ω–æ

–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã —É—Å–ø–µ—à–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã! –≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π.

## üìã –ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `plan` –≤ —Ç–∞–±–ª–∏—Ü—É users
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `metadata` –≤ —Ç–∞–±–ª–∏—Ü—É payments  
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ view `active_subscriptions`
- ‚úÖ –§—É–Ω–∫—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å—Ç–µ–∫—à–∏—Ö –ø–æ–¥–ø–∏—Å–æ–∫
- ‚úÖ –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–æ–∫, –∏—Å—Ç–µ–∫–∞—é—â–∏—Ö —Å–∫–æ—Ä–æ

### 2. Backend API
- ‚úÖ Trial (7 –¥–Ω–µ–π) –ø—Ä–∏ –ø–µ—Ä–≤–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- ‚úÖ Payment webhook –ø—Ä–æ–¥–ª–µ–≤–∞–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É
- ‚úÖ Payment create –ø–µ—Ä–µ–¥–∞–µ—Ç telegram_id
- ‚úÖ API –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (`/api/subscription/check`)
- ‚úÖ Subscription utilities library

### 3. Frontend
- ‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `SubscriptionStatus`
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π Dashboard —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –ø–æ–¥–ø–∏—Å–∫–∏
- ‚úÖ –ö–Ω–æ–ø–∫–∞ "–û—Ñ–æ—Ä–º–∏—Ç—å/–ü—Ä–æ–¥–ª–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É"

### 4. Telegram Bot
- ‚úÖ –ö–æ–º–∞–Ω–¥–∞ `/subscription` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–ø–∏—Å–∫–∏
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ `/help`

### 5. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

---

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é

### –®–∞–≥ 1: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

–û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard ‚Üí SQL Editor –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Ñ–∞–π–ª—ã –ø–æ –ø–æ—Ä—è–¥–∫—É:

#### 1.1 –î–æ–±–∞–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –ø–æ–¥–ø–∏—Å–æ–∫
```sql
-- –§–∞–π–ª: supabase/add_subscription_system.sql
-- –ö–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—Å—Ç–∞–≤–ª—è–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç:
- –î–æ–±–∞–≤–∏—Ç –ø–æ–ª–µ `plan` –≤ —Ç–∞–±–ª–∏—Ü—É users
- –î–æ–±–∞–≤–∏—Ç –ø–æ–ª–µ `metadata` –≤ —Ç–∞–±–ª–∏—Ü—É payments
- –°–æ–∑–¥–∞—Å—Ç view –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫
- –û–±–Ω–æ–≤–∏—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–¥–∞—Å—Ç –∏–º trial)

#### 1.2 –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å—Ç–µ–∫—à–∏—Ö –ø–æ–¥–ø–∏—Å–æ–∫
```sql
-- –§–∞–π–ª: supabase/check_expired_subscriptions.sql  
-- –ö–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—Å—Ç–∞–≤–ª—è–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞—Å—Ç —Ñ—É–Ω–∫—Ü–∏–∏:
- `check_expired_subscriptions()` - –ø–æ–º–µ—á–∞–µ—Ç –∏—Å—Ç–µ–∫—à–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏
- `get_expiring_soon_subscriptions()` - –Ω–∞—Ö–æ–¥–∏—Ç –ø–æ–¥–ø–∏—Å–∫–∏, –∏—Å—Ç–µ–∫–∞—é—â–∏–µ —Å–∫–æ—Ä–æ

#### 1.3 (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –ø—Ä–æ–≤–µ—Ä–∫—É
```sql
-- –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å pg_cron:
SELECT cron.schedule(
  'check-expired-subscriptions',
  '0 2 * * *',  -- –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 2 AM
  'SELECT check_expired_subscriptions();'
);
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–∞–∑–µ

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã:

```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ–ª–µ plan –¥–æ–±–∞–≤–ª–µ–Ω–æ
SELECT column_name, data_type, column_default 
FROM information_schema.columns 
WHERE table_name = 'users' AND column_name IN ('plan', 'subscription_expires', 'balance');

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ metadata –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ payments
SELECT column_name, data_type 
FROM information_schema.columns 
WHERE table_name = 'payments' AND column_name = 'metadata';

-- –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏
SELECT * FROM active_subscriptions LIMIT 5;

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏
SELECT * FROM check_expired_subscriptions();
```

### –®–∞–≥ 3: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å (Ctrl+C)
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ
npm run dev
```

### –®–∞–≥ 4: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Telegram –±–æ—Ç–∞

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—É—â–∏–π –±–æ—Ç (Ctrl+C)
cd telegram-bot

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ
python bot.py

# –ò–ª–∏ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç
./START.sh
```

### –®–∞–≥ 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### 5.1 –¢–µ—Å—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram –±–æ—Ç
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`
3. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Å—Å—ã–ª–∫—É –¥–ª—è –≤—Ö–æ–¥–∞
4. –ü–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:

```sql
SELECT id, telegram_id, plan, subscription_expires, balance
FROM users
WHERE telegram_id = YOUR_TELEGRAM_ID;
```

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
- `plan = 'trial'`
- `subscription_expires` —á–µ—Ä–µ–∑ 7 –¥–Ω–µ–π –æ—Ç —Å–µ–π—á–∞—Å
- `balance = 0`

#### 5.2 –¢–µ—Å—Ç –∫–æ–º–∞–Ω–¥—ã /subscription

1. –í –±–æ—Ç–µ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ `/subscription`
2. –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:
   - –°—Ç–∞—Ç—É—Å: –ü—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥
   - –û—Å—Ç–∞–ª–æ—Å—å –¥–Ω–µ–π: 7
   - –ö–Ω–æ–ø–∫—É "–û—Ñ–æ—Ä–º–∏—Ç—å/–ü—Ä–æ–¥–ª–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É"

#### 5.3 –¢–µ—Å—Ç Dashboard

1. –û—Ç–∫—Ä–æ–π—Ç–µ dashboard (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ª–æ–≥–∏–Ω–µ–Ω—ã)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è:
   - –ö–∞—Ä—Ç–æ—á–∫–∞ "–ü–æ–¥–ø–∏—Å–∫–∞" —Å–ø—Ä–∞–≤–∞
   - –°—Ç–∞—Ç—É—Å "–ü—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥"
   - –û—Å—Ç–∞–ª–æ—Å—å 7 –¥–Ω–µ–π
   - –ö–Ω–æ–ø–∫–∞ "–û—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É"

#### 5.4 –¢–µ—Å—Ç –æ–ø–ª–∞—Ç—ã

1. –ù–∞ dashboard –Ω–∞–∂–º–∏—Ç–µ "–û—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É"
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø–ª–∞–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, month)
3. –ü—Ä–æ–≤–µ–¥–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂
4. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - –í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö `plan` –∏–∑–º–µ–Ω–∏–ª—Å—è –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π
   - `subscription_expires` –ø—Ä–æ–¥–ª–∏–ª—Å—è
   - –í dashboard –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å

#### 5.5 –¢–µ—Å—Ç Mobile API

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–ø–∏—Å–∫–∏
curl -X POST http://localhost:3000/api/subscription/check \
  -H "Content-Type: application/json" \
  -d '{"telegram_id": YOUR_TELEGRAM_ID}'

# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å:
# {
#   "user_id": "uuid",
#   "telegram_id": 123456789,
#   "plan": "trial",
#   "subscription_expires": "2024-01-07T00:00:00.000Z",
#   "is_active": true,
#   "is_trial": true,
#   "is_expired": false,
#   "days_remaining": 7,
#   "balance": 0
# }
```

---

## üìä –°—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí Telegram Bot (/start)
    ‚Üì
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞ (1 —á–∞—Å)
    ‚Üì
–ö–ª–∏–∫ –ø–æ —Å—Å—ã–ª–∫–µ ‚Üí Dashboard
    ‚Üì
–ü–µ—Ä–≤—ã–π –≤—Ö–æ–¥: —Å–æ–∑–¥–∞–Ω–∏–µ user —Å trial (7 –¥–Ω–µ–π)
    ‚Üì
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç dashboard:
- –°—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏: –ü—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥
- –û—Å—Ç–∞–ª–æ—Å—å: 7 –¥–Ω–µ–π
- –ö–Ω–æ–ø–∫–∞: –û—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
    ‚Üì
–ö–ª–∏–∫ "–û—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É" ‚Üí /pay
    ‚Üì
–í—ã–±–æ—Ä –ø–ª–∞–Ω–∞ (month/halfyear/year)
    ‚Üì
–û–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ Enot.io
    ‚Üì
Webhook –ø–æ–ª—É—á–∞–µ—Ç –ø–ª–∞—Ç–µ–∂:
- –ù–∞—Ö–æ–¥–∏—Ç user –ø–æ telegram_id –∏–∑ metadata
- –ü—Ä–æ–¥–ª–µ–≤–∞–µ—Ç subscription_expires
- –û–±–Ω–æ–≤–ª—è–µ—Ç plan
- –°–æ–∑–¥–∞–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
    ‚Üì
Dashboard –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è:
- –°—Ç–∞—Ç—É—Å: –ê–∫—Ç–∏–≤–Ω–∞
- –ü–ª–∞–Ω: –≤—ã–±—Ä–∞–Ω–Ω—ã–π
- –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è
    ‚Üì
/subscription –≤ –±–æ—Ç–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å
    ‚Üì
–ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —á–µ—Ä–µ–∑ API
```

---

## üîÑ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–µ–∫—à–∏—Ö –ø–æ–¥–ø–∏—Å–æ–∫

–§—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å. –ï—Å–ª–∏ —É –≤–∞—Å –Ω–µ—Ç pg_cron, –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –≤—Ä—É—á–Ω—É—é –∏–ª–∏ —á–µ—Ä–µ–∑ Supabase Edge Function:

**–í–∞—Ä–∏–∞–Ω—Ç 1: –í—Ä—É—á–Ω—É—é (–¥–ª—è —Ç–µ—Å—Ç–∞)**
```sql
SELECT * FROM check_expired_subscriptions();
```

**–í–∞—Ä–∏–∞–Ω—Ç 2: Edge Function —Å Cron** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
–°–æ–∑–¥–∞–π—Ç–µ Edge Function –≤ Supabase Dashboard –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ cron trigger.

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–¥–ø–∏—Å–æ–∫

```sql
-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø–ª–∞–Ω–∞–º
SELECT plan, COUNT(*) as count
FROM users
GROUP BY plan;

-- –ü–æ–¥–ø–∏—Å–∫–∏, –∏—Å—Ç–µ–∫–∞—é—â–∏–µ —Å–∫–æ—Ä–æ (3 –¥–Ω—è)
SELECT * FROM get_expiring_soon_subscriptions();

-- –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏
SELECT COUNT(*) FROM users
WHERE subscription_expires < NOW() AND plan != 'expired';
```

---

## üì± –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–æ–±–∏–ª—å–Ω—ã–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º

–°–º. –ø–æ–¥—Ä–æ–±–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤ —Ñ–∞–π–ª–µ: `MOBILE_API.md`

–û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:
- `POST /api/subscription/check` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–ø–∏—Å–∫–∏
- `GET /api/subscription/check?telegram_id=123` - —Ç–æ –∂–µ —á–µ—Ä–µ–∑ GET
- `POST /api/auth/verify-token` - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ —Ç–æ–∫–µ–Ω

---

## üêõ Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–æ–ª–µ `plan` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
**–†–µ—à–µ–Ω–∏–µ**: –í—ã–ø–æ–ª–Ω–∏—Ç–µ `supabase/add_subscription_system.sql`

### –ü—Ä–æ–±–ª–µ–º–∞: Webhook –Ω–µ –ø—Ä–æ–¥–ª–µ–≤–∞–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É
**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ**:
1. –í payments –µ—Å—Ç—å –ø–æ–ª–µ metadata
2. –í metadata —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è telegram_id –∏ plan_type
3. Webhook –ª–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π plan_type

### –ü—Ä–æ–±–ª–µ–º–∞: Dashboard –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É
**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ**:
1. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç SubscriptionStatus.tsx —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
2. Dashboard –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç –ø–æ–ª–µ plan –≤ –±–∞–∑–µ

### –ü—Ä–æ–±–ª–µ–º–∞: /subscription –≤ –±–æ—Ç–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ**:
1. –ë–æ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
2. –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü–µ users
3. –õ–æ–≥–∏ –±–æ—Ç–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –æ—à–∏–±–∫–∏

---

## ‚ú® –ß—Ç–æ –¥–∞–ª—å—à–µ?

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (—Å–¥–µ–ª–∞–Ω–æ)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–æ–∫ –≤ –±–∞–∑—É
- ‚úÖ Trial –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- ‚úÖ Webhook –ø—Ä–æ–¥–ª–µ–Ω–∏—è
- ‚úÖ Dashboard –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- ‚úÖ Mobile API
- ‚úÖ Bot –∫–æ–º–∞–Ω–¥–∞ /subscription

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å)
- ‚ö™ –°—Ç—Ä–∞–Ω–∏—Ü–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–æ–π (`/subscription` route)
- ‚ö™ –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
- ‚ö™ –û—Ç–º–µ–Ω–∞ –ø–æ–¥–ø–∏—Å–∫–∏
- ‚ö™ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –∏—Å—Ç–µ—á–µ–Ω–∏–∏ (–∑–∞ 3 –¥–Ω—è)
- ‚ö™ Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚ö™ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ –±–æ—Ç–∞

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- ‚ö™ –ü—Ä–æ–º–æ–∫–æ–¥—ã —Å–æ —Å–∫–∏–¥–∫–∞–º–∏
- ‚ö™ –°–µ–º–µ–π–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏
- ‚ö™ –ü–æ–¥–∞—Ä–æ—á–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏
- ‚ö™ –†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ –±–æ–Ω—É—Å—ã –≤ –≤–∏–¥–µ –¥–Ω–µ–π –ø–æ–¥–ø–∏—Å–∫–∏
- ‚ö™ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –±–æ—Ç–∞
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Supabase –ª–æ–≥–∏
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏–∑ —ç—Ç–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤—Å–µ —Ñ–∞–π–ª—ã –ø—Ä–∏–º–µ–Ω–µ–Ω—ã

---

## üìù –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–æ–º

- [ ] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∞ (–≤—Å–µ SQL —Å–∫—Ä–∏–ø—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω—ã)
- [ ] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω–æ
- [ ] –ë–æ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
- [ ] –¢–µ—Å—Ç—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–æ–π–¥–µ–Ω—ã
- [ ] –¢–µ—Å—Ç—ã –æ–ø–ª–∞—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã
- [ ] Mobile API –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
- [ ] Webhook —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –ø–ª–∞—Ç–µ–∂–∞–º–∏
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–µ–∫—à–∏—Ö –ø–æ–¥–ø–∏—Å–æ–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –∫–æ–º–∞–Ω–¥—ã —Å–æ–∑–¥–∞–Ω–∞

---

**üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**


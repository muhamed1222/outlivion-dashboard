# Logging Quick Reference

## Import Statement

**Server-side** (API routes, server components, lib files):
```typescript
import { logger } from '@/lib/logger'
```

**Client-side** (React components with 'use client'):
```typescript
import { logger } from '@/lib/logger.client'
```

## Usage Patterns

### Information Logging
```typescript
logger.info({
  event_type: 'operation_completed',
  source: 'route_name',
  user_id: userId,
  // ...additional context
}, 'Human readable message')
```

### Error Logging
```typescript
// With Error object
logger.error(error, 'Operation failed')

// With structured context
logger.error({
  event_type: 'operation_failed',
  source: 'route_name',
  error: error.message,
  // ...additional context
}, 'Operation failed')
```

### Debug Logging (dev only)
```typescript
logger.debug({
  event_type: 'debugging_info',
  source: 'route_name',
  data: someData
}, 'Debug information')
```

## Required Fields

Always include:
- **event_type**: Categorize the log (e.g., `payment_created`, `auth_error`)
- **source**: Identify origin (e.g., `payment_webhook`, `login_page`)

## Common Event Types by Area

### Authentication
- `token_verification_started`
- `token_expired`
- `auth_error`
- `session_created`

### Payments
- `payment_created`
- `payment_completed`
- `payment_failed`
- `webhook_received`

### Subscriptions
- `subscription_extended`
- `subscription_expired`
- `subscription_check_error`

### User Operations
- `user_data_fetch_error`
- `profile_created`
- `profile_migrated`

## Environment Behavior

**Development** (`NODE_ENV=development`):
```
[14:23:45] INFO (payment_webhook): Payment processed successfully
    event_type: "payment_completed"
    payment_id: "abc123"
    amount: 199
```

**Production** (`NODE_ENV=production`):
```json
{"level":30,"time":1698765432000,"event_type":"payment_completed","source":"payment_webhook","payment_id":"abc123","amount":199,"msg":"Payment processed successfully"}
```

## Tips

1. **Be Descriptive**: Use clear event_types that describe what happened
2. **Add Context**: Include IDs, amounts, and relevant data
3. **Avoid Sensitive Data**: Don't log passwords, tokens, or personal info
4. **Use Proper Levels**: info for normal flow, error for failures
5. **Child Loggers**: Use `logger.child()` for route-scoped logging with shared context

## Migration from console

❌ **Before:**
```typescript
console.log('[Webhook] Processing payment:', paymentId)
console.error('Payment failed:', error)
```

✅ **After:**
```typescript
logger.info({
  event_type: 'payment_processing',
  source: 'payment_webhook',
  payment_id: paymentId
}, 'Processing payment')

logger.error({
  event_type: 'payment_failed',
  source: 'payment_webhook',
  error: error.message
}, 'Payment failed')
```


# üîí Security Note: glob vulnerability

## –°—Ç–∞—Ç—É—Å —É—è–∑–≤–∏–º–æ—Å—Ç–∏

**–ü–∞–∫–µ—Ç:** glob@10.2.0-10.5.0  
**Severity:** HIGH  
**–ü—É—Ç—å:** eslint-config-next ‚Üí @next/eslint-plugin-next ‚Üí glob  
**–ü—Ä–æ–±–ª–µ–º–∞:** Command injection via -c/--cmd

---

## ‚ö†Ô∏è –í–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å

### –≠—Ç–æ –ù–ï –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è production! ‚úÖ

**–ü—Ä–∏—á–∏–Ω–∞:**
1. –£—è–∑–≤–∏–º–æ—Å—Ç—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ **dev dependency** (eslint-config-next)
2. –ü–∞–∫–µ—Ç glob –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤–æ –≤—Ä–µ–º—è **—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏** –¥–ª—è ESLint
3. glob **–ù–ï –≤–∫–ª—é—á–∞–µ—Ç—Å—è** –≤ production bundle
4. –£—è–∑–≤–∏–º–æ—Å—Ç—å **–ù–ï –≤–ª–∏—è–µ—Ç** –Ω–∞ —Ä–∞–±–æ—Ç–∞—é—â–µ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### –ö—Ç–æ –ø–æ–¥ —Ä–∏—Å–∫–æ–º:
- ‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è - **–ù–ï–¢**
- ‚ùå Production —Å–µ—Ä–≤–µ—Ä - **–ù–ï–¢**
- ‚ö†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ (dev –æ–∫—Ä—É–∂–µ–Ω–∏–µ) - **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∏—Å–∫**

---

## üîß –ü–æ—á–µ–º—É –Ω–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞?

–£—è–∑–≤–∏–º–æ—Å—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ `eslint-config-next@16`, –Ω–æ:
- –¢—Ä–µ–±—É–µ—Ç Next.js 15/16 (breaking changes)
- –¢—Ä–µ–±—É–µ—Ç ESLint 9 (breaking changes)  
- –¢—Ä–µ–±—É–µ—Ç –º–∏–≥—Ä–∞—Ü–∏—é –≤—Å–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ ESLint

**–í—ã–±–æ—Ä:** –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å > —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å –≤ dev tools

---

## ‚úÖ –ß—Ç–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

1. ‚úÖ HttpOnly cookies
2. ‚úÖ sameSite: 'strict'
3. ‚úÖ Secure –≤ production
4. ‚úÖ Middleware –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
5. ‚úÖ TypeScript strict mode
6. ‚úÖ Zod –≤–∞–ª–∏–¥–∞—Ü–∏—è
7. ‚úÖ No ESLint errors

---

## üìã –ü–ª–∞–Ω —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç 1: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ (–∫–æ–≥–¥–∞ –±—É–¥–µ—Ç –≤—Ä–µ–º—è)
```bash
# –û–±–Ω–æ–≤–∏—Ç—å Next.js –¥–æ v16
pnpm update next@latest eslint-config-next@latest

# –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ ESLint 9
# –¢—Ä–µ–±—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–∏—Ç—å .eslintrc.json –¥–ª—è flat config

# –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏
```

**–û—Ü–µ–Ω–∫–∞:** 4-6 —á–∞—Å–æ–≤ (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ + –º–∏–≥—Ä–∞—Ü–∏—è)

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å (—Ç–µ–∫—É—â–∏–π –ø–æ–¥—Ö–æ–¥)
- –£—è–∑–≤–∏–º–æ—Å—Ç—å —Ç–æ–ª—å–∫–æ –≤ dev –æ–∫—Ä—É–∂–µ–Ω–∏–∏
- –ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ production
- –ú–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –¥–æ –º–∞–∂–æ—Ä–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è Next.js

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å: –ü–†–ò–ï–ú–õ–ï–ú–û** ‚úÖ

–£—è–∑–≤–∏–º–æ—Å—Ç—å –∏–º–µ–µ—Ç **–Ω–∏–∑–∫–∏–π —Ä–µ–∞–ª—å–Ω—ã–π —Ä–∏—Å–∫** –ø–æ—Ç–æ–º—É —á—Ç–æ:
1. –¢–æ–ª—å–∫–æ dev dependency
2. –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ runtime
3. –ù–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è –≤ production build
4. –¢—Ä–µ–±—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ dev –æ–∫—Ä—É–∂–µ–Ω–∏—é

**–î–µ–π—Å—Ç–≤–∏–µ:** –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –º–∞–∂–æ—Ä–Ω–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ Next.js (v15/v16)

---

## üìä –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–ë–æ–ª–µ–µ –≤–∞–∂–Ω—ã–µ –∑–∞–¥–∞—á–∏:**
1. üî¥ –î–æ–±–∞–≤–∏—Ç—å 2FA (–∑–∞—â–∏—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
2. üî¥ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Sentry (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—à–∏–±–æ–∫)
3. üü° –î–æ–±–∞–≤–∏—Ç—å rate limiting (–∑–∞—â–∏—Ç–∞ –æ—Ç brute force)
4. üü° –î–æ–±–∞–≤–∏—Ç—å CSP headers (–∑–∞—â–∏—Ç–∞ –æ—Ç XSS)
5. üü¢ –û–±–Ω–æ–≤–∏—Ç—å glob —á–µ—Ä–µ–∑ Next.js 16

---

**–í—ã–≤–æ–¥:** –§–æ–∫—É—Å–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ runtime –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –∞ –Ω–µ dev tools —É—è–∑–≤–∏–º–æ—Å—Ç—è—Ö.

# YooKassa Quick Start Guide üöÄ

## 5-–º–∏–Ω—É—Ç–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### 1. –ü–æ–ª—É—á–∏—Ç—å credentials (2 –º–∏–Ω)

1. –ó–∞–π—Ç–∏ –Ω–∞ https://yookassa.ru/
2. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Üí –í–æ–π—Ç–∏ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
3. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
4. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å:
   - **Shop ID**: `123456`
   - **Secret Key**: `live_xxxxxxxxxxxxxxxxxxxxxxxx`

### 2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î (1 –º–∏–Ω)

**–ß–µ—Ä–µ–∑ Supabase Dashboard:**
1. SQL Editor ‚Üí New Query
2. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `supabase/add_payment_gateway_fields.sql`
3. Run

**–ò–ª–∏ —á–µ—Ä–µ–∑ psql:**
```bash
psql -h <SUPABASE_HOST> -U postgres -d postgres -f supabase/add_payment_gateway_fields.sql
```

### 3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Environment Variables (1 –º–∏–Ω)

**–õ–æ–∫–∞–ª—å–Ω–æ** (`.env.local`):
```env
YOOKASSA_SHOP_ID=your_shop_id
YOOKASSA_SECRET_KEY=your_secret_key
ENABLE_YOOKASSA=true
```

**Vercel** (Production):
```bash
vercel env add YOOKASSA_SHOP_ID
vercel env add YOOKASSA_SECRET_KEY
vercel env add ENABLE_YOOKASSA  # –∑–Ω–∞—á–µ–Ω–∏–µ: true
```

### 4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Webhook (1 –º–∏–Ω)

1. –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç YooKassa ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
2. –î–æ–±–∞–≤–∏—Ç—å HTTP-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:
   - **URL**: `https://yourdomain.com/api/payment/webhook/yookassa`
   - **–°–æ–±—ã—Ç–∏—è**: 
     - ‚úÖ `payment.succeeded`
     - ‚úÖ `payment.canceled`
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å

### 5. Deploy –∏ Test (30 —Å–µ–∫)

```bash
# Deploy
git add .
git commit -m "feat: integrate YooKassa"
git push origin main

# Test
curl -X POST https://yourdomain.com/api/payment/create \
  -H "Content-Type: application/json" \
  -d '{
    "user_id": "YOUR_USER_UUID",
    "method": "card",
    "gateway": "yookassa",
    "plan_type": "month"
  }'
```

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `/pay` –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —É–≤–∏–¥—è—Ç –≤—ã–±–æ—Ä:
- **Enot.io** (–∫–∞—Ä—Ç—ã, –°–ë–ü)
- **–ÆKassa** (–∫–∞—Ä—Ç—ã, –°–ë–ü, SberPay, –ÆMoney, Tinkoff Pay) ‚≠ê NEW

## –¢–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã

| –ù–æ–º–µ—Ä | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|-------|-----------|
| `5555555555554477` | ‚úÖ –£—Å–ø–µ—à–Ω–æ |
| `5555555555554444` | ‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω–æ |

CVV: `123` | –°—Ä–æ–∫: `12/25`

## Troubleshooting

### ‚ùå "YooKassa is disabled"

**–†–µ—à–µ–Ω–∏–µ**: `ENABLE_YOOKASSA=true` (—Å—Ç—Ä–æ–∫–∞, –Ω–µ boolean)

### ‚ùå "YooKassa credentials are not configured"

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `YOOKASSA_SHOP_ID` –∏ `YOOKASSA_SECRET_KEY`

### ‚ùå Webhook –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å URL –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö YooKassa

## üìö –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: `YOOKASSA_INTEGRATION.md`
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: `YOOKASSA_TESTING.md`
- **Summary**: `YOOKASSA_IMPLEMENTATION_SUMMARY.md`

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- YooKassa: support@yookassa.ru
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: https://yookassa.ru/developers/api

---

**Status**: ‚úÖ Production Ready  
**Version**: 1.0.0

